{"version":3,"sources":["components/csys.jsx","components/ThreeBox_full.jsx","components/ControlElements.jsx","components/ModelControls.jsx","components/Graph.jsx","components/Schematic.jsx","components/ParamButtons.jsx","components/Model.jsx","App.js","serviceWorker.js","index.js"],"names":["moles2GtC","moles","uatm2GtC","uatm","GtC2uatm","GtC","calc_Ks","Tc","Sal","sqrtSal","Math","sqrt","T","lnT","log","K0","exp","K1","pow","K2","KW","KB","KspC","log10","KspA","Delta","b","RT","FugFac","calc_csys","DIC","TA","Ks","H","BT","diff_H","HCO3","CO3","OH","abs","give_DIC_TA","pH","CO2","fCO2","pCO2","c","paramLabels","PO4","SA_ocean","start_state","vol_ocean","update_csys","state","csys_deep","csys_hilat","csys_lolat","cvar","box","calc_fluxes","fluxes","vmix_PO4_hilat","vmix","PO4_hilat","PO4_deep","vmix_PO4_lolat","PO4_lolat","vmix_DIC_hilat","DIC_hilat","DIC_deep","vmix_DIC_lolat","DIC_lolat","vmix_TA_hilat","TA_hilat","TA_deep","vmix_TA_lolat","TA_lolat","vcirc_PO4_deep","vcirc","vcirc_PO4_lolat","vcirc_PO4_hilat","vcirc_DIC_deep","vcirc_DIC_lolat","vcirc_DIC_hilat","vcirc_TA_deep","vcirc_TA_lolat","vcirc_TA_hilat","prod_PO4_hilat","vol_hilat","tau_hilat","prod_PO4_lolat","vol_lolat","tau_lolat","f_DIC_lolat","percent_CaCO3_lolat","f_DIC_hilat","percent_CaCO3_hilat","prod_DIC_hilat","prod_DIC_lolat","f_TA_lolat","f_TA_hilat","prod_TA_hilat","prod_TA_lolat","exCO2_lolat","kas","SA_lolat","pCO2_atmos","pCO2_lolat","exCO2_hilat","SA_hilat","pCO2_hilat","var_info","label","ymin","ymax","precision","VerticalSlider","React","Component","props","handleChange","value","bind","fmtLabel","this","fmt_info","min","max","orientation","onChange","format","labels","step","fmt_sci","toExponential","fmt_pre","toPrecision","fmt_fix","decimals","toFixed","paramFormats","temp_hilat","temp_lolat","sliderLabels","ControlSet","handleDouble","handleHalve","handleSliderChange","e","handleUpdate","param","stepsize","className","dangerouslySetInnerHTML","__html","Disasters","GtC_pinutubo","emitLabel","handleStHelens","handlePinatubo","handleEmissions","handleVolcano","setState","style","zIndex","GtC_released","onClick","size","calc_deltaF","calc_deltaT","RadiativeForcing","pCO2_atmos_noExch","ModelControls","controls","params","p","push","key","now","title","Graph","interval","graph","data","make_data","pad","mn","Infinity","mx","d","v","variables","rn","pdatas","pdata","ix","length","i","bb","d3","id","node","getBoundingClientRect","svg_height","height","svg_width","width","xScale","domain","npoints","range","yScale","getYLimits","svg","append","attr","yAxis","ticks","call","xAxis","lines","x","y","selectAll","scale","select","clearInterval","initGraph","updateXlim","updateYlim","updateLine","left","pos","bottom","flux_labels","flux_colors","Box","backgroundColor","color","mapValue","val","h","s","parseHSL","l","Schematic","gMin","gMax","limits","getLimits","ind","val_atmos","val_deep","col_deep","val_lolat","col_lolat","val_hilat","col_hilat","GtC_atmos","GtC_deep","GtC_lolat","GtC_hilat","legend","plot_hilat","plot_lolat","plot_deep","sizes","centre","colors","Fluxes","arrowWidthPercent","arrowHeightPercent","top","arrows","n","direction","amplitude","labelPos","Arrow","arrowStyle","size_2_percent","ParamToggle","buttons","ToggleButton","ToggleButtonGroup","type","name","defaultValue","GtC_atmos_0","Model","history","year_field","frameTime","genKs","Array","fill","yearsPerSecond","plot_ocean","running","emitting","stepModel","startSimulation","stopSimulation","resetModel","toggleSimulation","genPlotVars","handleDropdownSelect","handleParamButtonChange","handleParamToggle","handleParamUpdate","toggleEmissions","onChangeYears","onYearsEnter","handleUpdateYears","handleSpeedUp","handleSlowDown","setInterval","start_stop_button","updateHistory","newState","totalEmissions","Object","assign","vol_deep","newHistory","len","slice","schematicParam","plotvars","temp_deep","sal_deep","sal_hilat","sal_lolat","event","target","newFrameTime","newYearsPerSecond","model_global_params","model_hilat_params","model_lolat_params","ocean_vars","InputGroup","Prepend","Text","FormControl","placeholder","aria-label","aria-describedby","onKeyPress","Append","ButtonGroup","href","App","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.8a8d02e4.chunk.js","sourcesContent":["// functions for calculating C chemistry\n\nconst BT35 = 415.7e-6 / 35.;  // umol / kg / sal\nconst RGasConstant = 83.1451; // ml bar-1 K-1 mol-1, DOEv2\n\nexport function moles2uatm(moles) {\n    return moles * 12 / 2.13e15\n}\n\nexport function uatm2moles(uatm) {\n    return uatm * 2.13e15 / 12\n}\n\nexport function GtC2moles(GtC) {\n    return GtC * 1e15 / 12\n}\n\nexport function moles2GtC(moles) {\n    return moles * 1e-15 * 12\n}\n\nexport function uatm2GtC(uatm) {\n    return uatm * 2.13\n}\n\nexport function GtC2uatm(GtC) {\n    return GtC / 2.13\n}\n\nexport function calc_Ks({ Tc, Sal }) {\n    let sqrtSal = Math.sqrt(Sal);\n    let T = Tc + 273.15;\n    let lnT = Math.log(T);\n\n    let K0 = Math.exp(-60.2409 + 93.4517 * 100 / T + 23.3585 * Math.log(T / 100) + Sal * (0.023517 - 0.023656 * T / 100 + 0.0047036 * (T / 100) * (T / 100)));  // Weiss74\n    let K1 = Math.pow(10, -3633.86 / T + 61.2172 - 9.67770 * lnT + 0.011555 * Sal - 0.0001152 * Sal * Sal)  // Dickson\n    let K2 = Math.pow(10, -471.78 / T - 25.9290 + 3.16967 * lnT + 0.01781 * Sal - 0.0001122 * Sal * Sal);\n\n    let KW = Math.exp(148.9652 - 13847.26 / T - 23.6521 * lnT + (118.67 / T - 5.977 + 1.0495 * lnT) * sqrtSal - 0.01615 * Sal)\n    let KB = Math.exp((-8966.90 - 2890.53 * sqrtSal - 77.942 * Sal + 1.728 * Sal * sqrtSal - 0.0996 * Sal * Sal) / T + (148.0248 + 137.1942 * sqrtSal + 1.62142 * Sal) + (-24.4344 - 25.085 * sqrtSal - 0.2474 * Sal) * lnT + 0.053105 * sqrtSal * T);  // Dickson90b\n\n    let KspC = Math.pow(10, (-171.9065 - 0.077993 * T + 2839.319 / T + 71.595 * Math.log10(T) + (-0.77712 + 0.0028426 * T + 178.34 / T) * sqrtSal - 0.07711 * Sal + 0.0041249 * Sal * sqrtSal))\n    let KspA = Math.pow(10, (-171.945 - 0.077993 * T + 2903.293 / T + 71.595 * Math.log10(T) + (-0.068393 + 0.0017276 * T + 88.135 / T) * sqrtSal - 0.10018 * Sal + 0.0059415 * Sal * sqrtSal))\n\n    let Delta = (57.7 - 0.118 * T);\n    let b = -1636.75 + 12.0408 * T - 0.0327957 * T**2 + 3.16528 * 0.00001 * T**3;\n    let P1atm = 1.01325;\n    let RT = RGasConstant * T;\n    let FugFac = Math.exp((b + 2 * Delta) * P1atm / RT);\n\n    return {\n        K0: K0,\n        K1: K1,\n        K2: K2,\n        KB: KB,\n        KW: KW,\n        KspA: KspA,\n        KspC: KspC,\n        FugFac: FugFac\n    }\n}\n\nexport function give_DIC_TA({ DIC, TA, Sal, Ks}) {\n    // Returns [H], units: mol/kg\n\n    let BT = BT35 * Sal;\n    let pH = 8.;\n    let H = 10 ** -pH;\n    let diff_H = H;\n    let tiny_diff_H = 1e-15;\n\n    let HCO3 = null;\n    let CO3 = null;\n    let CAlk = null;\n    let BAlk = null;\n    let OH = null;\n    let residual = null;\n    let slope = null;\n\n    while (Math.abs(diff_H) > tiny_diff_H) {\n        HCO3 = DIC / (1 + H / Ks.K1 + Ks.K2 / H);\n        CO3 = DIC / (1 + H / Ks.K2 + H**2 / (Ks.K1 * Ks.K2))\n        CAlk = HCO3 + 2 * CO3;\n        BAlk = BT * Ks.KB / (Ks.KB + H);\n        OH = Ks.KW / H;\n\n        residual = TA - CAlk - BAlk - OH + H;\n        slope = 1 + (2 * CO3 + HCO3 + OH) / H + BT * Ks.KB / (Ks.KB + H) ** 2\n\n        diff_H = residual / slope;\n        H -= diff_H;\n    }\n\n    return H\n}\n\nexport function give_H_CO2({H, CO2, Ks}) {\n    // Returns DIC, units: mol/kg\n    return CO2 * (1 + Ks.K1 / H + Ks.K1 * Ks.K2 / H ** 2)  // DIC\n}\n\n// For adding CO2 with conserved TA.\nexport function give_fCO2_TA({ fCO2, TA, Sal, Ks}) {\n    // Returns DIC, units: mol/kg\n    let BT = BT35 * Sal;\n\n    let CO2 = fCO2 * Ks.K0;\n    let pH = 8.;\n    let H = 10 ** -pH;\n    let diff_H = H;\n    let tiny_diff_H = 1e-15;\n\n    let HCO3 = null;\n    let CO3 = null;\n    let CAlk = null;\n    let BAlk = null;\n    let OH = null;\n    let residual = null;\n    let slope = null;\n\n    while (Math.abs(diff_H) > tiny_diff_H) {\n        HCO3 = Ks.K1 * CO2 / H;\n        CO3 = Ks.K1 * Ks.K2 * CO2 / H ** 2;\n        CAlk = HCO3 + 2 * CO3;\n        BAlk = BT * Ks.KB / (Ks.KB + H);\n        OH = Ks.KW / H;\n\n        residual = TA - CAlk - BAlk - OH + H;\n        slope = 1 + (2 * CO3 + HCO3 + OH) / H + BT * Ks.KB / (Ks.KB + H) ** 2\n\n        diff_H = residual / slope;\n        H -= diff_H;\n    }\n\n    return CO2 * (1 + Ks.K1 / H + Ks.K1 * Ks.K2 / H ** 2)  // DIC\n    // return H\n}\n\nexport function DIC_from_fCO2({ fCO2, TA, Sal, Ks }) {\n    TA *= 1e-6;\n    fCO2 *= 1e-6;\n\n    // let Ks = calc_Ks({ Tc: Temp, Sal: Sal })\n\n    let DIC = give_fCO2_TA({fCO2: fCO2, TA:TA, Sal: Sal, Ks:Ks})\n\n    return DIC\n}\n\nexport function calc_csys({ DIC, TA, Sal, Ks}) {\n    TA = TA * 1e-6;\n    DIC = DIC * 1e-6;\n\n    // let Ks = calc_Ks({ Tc: Temp, Sal: Sal })\n\n    let H = give_DIC_TA({DIC: DIC, TA:TA, Sal: Sal, Ks:Ks})\n\n    let pH = -Math.log10(H)\n    let CO2 = 1e6 * DIC / (1 + Ks.K1 / H + Ks.K1 * Ks.K2 / H**2)\n    let HCO3 = 1e6 * DIC / (1 + H / Ks.K1 + Ks.K2 / H);\n    let CO3 = 1e6 * DIC / (1 + H / Ks.K2 + H ** 2 / (Ks.K1 * Ks.K2));\n    let fCO2 = CO2 / Ks.K0;\n    let pCO2 = fCO2 / Ks.FugFac;\n\n    // Saturation measure\n    let c = 1e-6 * CO3 / (Ks.KspC / 10.2e-3)\n\n    return {\n        pH: pH,\n        fCO2: fCO2,\n        CO2: CO2,\n        HCO3: HCO3,\n        CO3: CO3,\n        c: c,\n        pCO2: pCO2, \n    }\n}\n\n","import { calc_csys, calc_Ks, moles2uatm } from './csys';\n\nexport const paramLabels = {\n    PO4: '[PO<sub>4</sub>]',\n    c: '\\u03A9',\n    DIC: 'DIC',\n    TA: 'TA',\n    fCO2: 'fCO<sub>2</sub>',\n    pCO2: 'pCO<sub>2</sub>',\n    pH: 'pH',\n    CO2: '[H<sub>2</sub>CO<sub>3</sub><sup>*</sup>]',\n    CO3: '[CO<sub>3</sub><sup>2-</sup>]',\n    HCO3: '[HCO<sub>3</sub><sup>-</sup>]',\n}\n\n// Box setup\nconst SA_ocean = 358e12;  // m2\nconst vol_ocean = 1.34e18  // m3\nconst fSA_hilat = 0.15;\nconst depth_hilat = 200;  // m\nconst vol_hilat = SA_ocean * fSA_hilat * depth_hilat;  // m3\nconst fSA_lolat = 1 - fSA_hilat;\nconst depth_lolat = 100;  // m\nconst vol_lolat = SA_ocean * fSA_lolat * depth_lolat;  // m3\n\n// const Sv_2_m3yr = 1e6 * (60 * 60 * 24 * 365);\n// const vcirc = 20;  // Sv\n// const vmix = 10;  // Sv\n\nexport var start_state = {\n    'kas': 0.02,  // air-sea gas exchange mol (uatm m2 yr-1)-1\n    // 'vmix': 1.2e15,\n    'vmix': 1.89e15,  // m3 yr-1\n    // 'vcirc': 6.3072e14,\n    'vcirc': 6.3072e14,  // m3 yr-1\n    'tau_hilat': 50,  // yr\n    'tau_lolat': 1,  // yr\n    'percent_CaCO3_hilat': 10,\n    'percent_CaCO3_lolat': 20,\n    'depth_lolat': depth_lolat,\n    'depth_hilat': depth_hilat,\n    'vol_ocean': vol_ocean,\n    'vol_deep': vol_ocean - vol_lolat - vol_hilat,  // m3\n    'vol_lolat': vol_lolat,  // m3\n    'vol_hilat': vol_hilat,  // m3\n    'mass_atmos': 5.132e18,  // kg\n    'moles_atmos': 1.773e20,  // moles\n    'SA_ocean': SA_ocean,  // m2\n    'fSA_hilat': fSA_hilat,\n    'fSA_lolat': fSA_lolat,\n    'SA_hilat': SA_ocean * fSA_hilat,\n    'SA_lolat': SA_ocean * fSA_lolat,\n    // Temp and sal from Table A.3 of Sarmiento & Gruber\n    'temp_deep': 1.92,\n    'temp_hilat': (4.21 + 3.22) / 2,\n    'temp_lolat': 22.85,\n    'sal_lolat': 35.15,\n    'sal_hilat': 33.5,\n    'sal_deep': 34.72,\n    'PO4_lolat': 0.182,  //0.31,\n    'PO4_hilat': 1.68,  //(0.89 + 1.54) / 2,\n    'PO4_deep': 2.38,\n    'DIC_lolat': 1969, // 1972,  //1958,  // total_DIC,\n    'DIC_hilat': 2183.1,  // 2192,  //(2006 + 2082) / 2,  // total_DIC,\n    'DIC_deep': 2260.5,  //2279,  // total_DIC,\n    'TA_lolat': 2253.4,  // 2244,  // 2315,  // total_TA,\n    'TA_hilat': 2344.1,  //2341,  // (2257 + 2291) / 2,  // total_TA,\n    'TA_deep': 2381.4,  // total_TA,\n    'pCO2_atmos': 372.75,\n    'pCO2_atmos_noExch': 372.75\n};\n\nfunction update_csys(state, Ks) {\n    let csys_deep = calc_csys({\n        DIC: state['DIC_deep'],\n        TA: state['TA_deep'],\n        Sal: state['sal_deep'],\n        Ks: Ks['deep']\n    })\n\n    let csys_hilat = calc_csys({\n        DIC: state['DIC_hilat'],\n        TA: state['TA_hilat'],\n        Sal: state['sal_hilat'],\n        Ks: Ks['hilat']\n    })\n\n    let csys_lolat = calc_csys({\n        DIC: state['DIC_lolat'],\n        TA: state['TA_lolat'],\n        Sal: state['sal_lolat'],\n        Ks: Ks['lolat']\n    })\n\n    for (let cvar of ['pH', 'fCO2', 'pCO2', 'CO2', 'HCO3', 'CO3', 'c']) {\n        state[cvar + '_deep'] = csys_deep[cvar]\n        state[cvar + '_lolat'] = csys_lolat[cvar]\n        state[cvar + '_hilat'] = csys_hilat[cvar]\n    }\n\n    return state\n}\n\n// update carbon system of start_state\nlet Ks = {};\nfor (let box of ['hilat', 'lolat', 'deep']) {\n    Ks[box] = calc_Ks({Tc: start_state['temp_' + box], Sal: start_state['sal_' + box]})\n}\nstart_state = update_csys(start_state, Ks)\n\n\nexport function calc_fluxes(state) {\n    let fluxes = {};\n    // vmix\n    fluxes.vmix_PO4_hilat = state.vmix * (state.PO4_hilat - state.PO4_deep);\n    fluxes.vmix_PO4_lolat = state.vmix * (state.PO4_lolat - state.PO4_deep);\n    // fluxes.vmix_PO4_lolat = 0;\n    fluxes.vmix_DIC_hilat = state.vmix * (state.DIC_hilat - state.DIC_deep);\n    fluxes.vmix_DIC_lolat = state.vmix * (state.DIC_lolat - state.DIC_deep);\n    // fluxes.vmix_DIC_lolat = 0;\n    fluxes.vmix_TA_hilat = state.vmix * (state.TA_hilat - state.TA_deep);\n    fluxes.vmix_TA_lolat = state.vmix * (state.TA_lolat - state.TA_deep);\n    // fluxes.vmix_TA_lolat = 0;\n\n    // vcirc\n    fluxes.vcirc_PO4_deep = state.vcirc * (state.PO4_hilat - state.PO4_deep);\n    fluxes.vcirc_PO4_lolat = state.vcirc * (state.PO4_deep - state.PO4_lolat);\n    fluxes.vcirc_PO4_hilat = state.vcirc * (state.PO4_lolat - state.PO4_hilat);\n    fluxes.vcirc_DIC_deep = state.vcirc * (state.DIC_hilat - state.DIC_deep);\n    fluxes.vcirc_DIC_lolat = state.vcirc * (state.DIC_deep - state.DIC_lolat);\n    fluxes.vcirc_DIC_hilat = state.vcirc * (state.DIC_lolat - state.DIC_hilat);\n    fluxes.vcirc_TA_deep = state.vcirc * (state.TA_hilat - state.TA_deep);\n    fluxes.vcirc_TA_lolat = state.vcirc * (state.TA_deep - state.TA_lolat);\n    fluxes.vcirc_TA_hilat = state.vcirc * (state.TA_lolat - state.TA_hilat);\n\n    // productivity\n    fluxes.prod_PO4_hilat = (state.PO4_hilat * state.vol_hilat / state.tau_hilat);\n    fluxes.prod_PO4_lolat = (state.PO4_lolat * state.vol_lolat / state.tau_lolat);\n    let f_DIC_lolat = 106 + 106 * state.percent_CaCO3_lolat / 100;\n    let f_DIC_hilat = 106 + 106 * state.percent_CaCO3_hilat / 100;\n    fluxes.prod_DIC_hilat = fluxes.prod_PO4_hilat * f_DIC_hilat\n    fluxes.prod_DIC_lolat = fluxes.prod_PO4_lolat * f_DIC_lolat\n    let f_TA_lolat = 0.15 * 106 + 2 * 106 * state.percent_CaCO3_lolat / 100;\n    let f_TA_hilat = 0.15 * 106 + 2 * 106 * state.percent_CaCO3_hilat / 100;\n    fluxes.prod_TA_hilat = fluxes.prod_PO4_hilat * f_TA_hilat\n    fluxes.prod_TA_lolat = fluxes.prod_PO4_lolat * f_TA_lolat\n\n    // CO2 exchange (moles yr-1)\n    fluxes.exCO2_lolat = state.kas * state.SA_lolat * (state.pCO2_atmos - state.pCO2_lolat)\n    fluxes.exCO2_hilat = state.kas * state.SA_hilat * (state.pCO2_atmos - state.pCO2_hilat)\n\n    return fluxes\n}\n\nexport function step(state, fluxes, Ks) {\n    // let fluxes = calc_fluxes(state);\n    let newState = Object.assign({}, state);\n    // let newState = state;\n\n    newState.PO4_deep += (fluxes.vmix_PO4_hilat + fluxes.vmix_PO4_lolat + fluxes.vcirc_PO4_deep + fluxes.prod_PO4_hilat + fluxes.prod_PO4_lolat) / state.vol_deep\n    newState.PO4_hilat += (- fluxes.vmix_PO4_hilat + fluxes.vcirc_PO4_hilat - fluxes.prod_PO4_hilat) / state.vol_hilat\n    newState.PO4_lolat += (- fluxes.vmix_PO4_lolat + fluxes.vcirc_PO4_lolat - fluxes.prod_PO4_lolat) / state.vol_lolat\n\n    newState.DIC_deep += (fluxes.vmix_DIC_hilat + fluxes.vmix_DIC_lolat + fluxes.vcirc_DIC_deep + fluxes.prod_DIC_hilat + fluxes.prod_DIC_lolat) / state.vol_deep\n    newState.DIC_hilat += (- fluxes.vmix_DIC_hilat + fluxes.vcirc_DIC_hilat - fluxes.prod_DIC_hilat + 1e3 * fluxes.exCO2_hilat) / state.vol_hilat\n    newState.DIC_lolat += (- fluxes.vmix_DIC_lolat + fluxes.vcirc_DIC_lolat - fluxes.prod_DIC_lolat + 1e3 * fluxes.exCO2_lolat) / state.vol_lolat\n\n    newState.TA_deep += (fluxes.vmix_TA_hilat + fluxes.vmix_TA_lolat + fluxes.vcirc_TA_deep + fluxes.prod_TA_hilat + fluxes.prod_TA_lolat) / state.vol_deep\n    newState.TA_hilat += (- fluxes.vmix_TA_hilat + fluxes.vcirc_TA_hilat - fluxes.prod_TA_hilat) / state.vol_hilat\n    newState.TA_lolat += (- fluxes.vmix_TA_lolat + fluxes.vcirc_TA_lolat - fluxes.prod_TA_lolat) / state.vol_lolat\n\n    newState.pCO2_atmos += moles2uatm(- fluxes.exCO2_hilat - fluxes.exCO2_lolat)\n\n    newState = update_csys(newState, Ks);\n    \n    return newState\n}\n\nexport const var_info = {\n    // variable: [label, min, max]\n    'vmix': {\n        label: 'Mixing Rate (m3 / yr)',\n        ymin: null,\n        ymax: null,\n        precision: null\n    },\n    'vcirc': {\n        label: 'Thermohaline Mixing Rate (m3 / yr)',\n        ymin: null,\n        ymax: null,\n        precision: null\n    },\n    'tau_lolat': {\n        label: 'Productivity (tau)',\n        ymin: null,\n        ymax: null,\n        precision: null\n    },\n    'tau_hilat': {\n        label: 'Productivity (tau)',\n        ymin: null,\n        ymax: null,\n        precision: null\n    },\n    'percent_CaCO3_lolat': {\n        label: '% CaCO3',\n        ymin: 0,\n        ymax: 100,\n        precision: 1\n    },\n    'percent_CaCO3': {\n        label: '% CaCO3',\n        ymin: 0,\n        ymax: 100,\n        precision: 1\n    },\n    'vol_deep': {\n        label: 'Ocean Volume (m3)',\n        ymin: null,\n        ymax: null,\n        precision: null\n    },\n    'vol_lolat': {\n        label: 'Ocean Volume (m3)',\n        ymin: null,\n        ymax: null,\n        precision: null\n    },\n    'vol_hilat': {\n        label: 'Ocean Volume (m3)',\n        ymin: null,\n        ymax: null,\n        precision: null\n    },\n    'PO4_lolat': {\n        label: '[PO4]',\n        ymin: 0,\n        ymax: 1,\n        precision: 3\n    },\n    'PO4_hilat': {\n        label: '[PO4]',\n        ymin: 0,\n        ymax: 1,\n        precision: 3\n    },\n    'PO4_deep': {\n        label: '[PO4]',\n        ymin: 2.4,\n        ymax: 2.6,\n        precision: 3\n    },\n    'DIC_hilat': {\n        label: '[DIC]',\n        ymin: 1800,\n        ymax: 2000,\n        precision: 4\n    },\n    'DIC_lolat': {\n        label: '[DIC]',\n        ymin: 1800,\n        ymax: 2000,\n        precision: 4\n    },\n    'DIC_deep': {\n        label: '[DIC]',\n        ymin: 2130,\n        ymax: 2150,\n        precision: 5\n    },\n    'TA_lolat': {\n        label: 'Alkalinity',\n        ymin: 2200,\n        ymax: 2400,\n        precision: 4\n    },\n    'TA_hilat': {\n        label: 'Alkalinity',\n        ymin: 2200,\n        ymax: 2400,\n        precision: 4\n    },\n    'TA_deep': {\n        label: 'Alkalinity',\n        ymin: 2390,\n        ymax: 2410,\n        precision: 5\n    },\n    'pH_deep': {\n        label: 'pH',\n        ymin: 7.5,\n        ymax: 8.5,\n        precision: 3\n    },\n    'fCO2_deep': {\n        label: 'fCO2',\n        ymin: 350,\n        ymax: 450,\n        precision: 3\n    },\n    'pCO2_deep': {\n        label: 'pCO2',\n        ymin: 350,\n        ymax: 450,\n        precision: 3\n    },\n    'CO2_deep': {\n        label: '[CO2]',\n        ymin: 5,\n        ymax: 15,\n        precision: 3\n    },\n    'HCO3_deep': {\n        label: '[HCO3]',\n        ymin: 1500,\n        ymax: 2000,\n        precision: 4\n    },\n    'CO3_deep': {\n        label: '[CO3]',\n        ymin: 70,\n        ymax: 120,\n        precision: 3\n    },\n    'pH_hilat': {\n        label: 'pH',\n        ymin: 7.5,\n        ymax: 8.5,\n        precision: 3\n    },\n    'fCO2_hilat': {\n        label: 'fCO2',\n        ymin: 350,\n        ymax: 450,\n        precision: 3\n    },\n    'pCO2_hilat': {\n        label: 'pCO2',\n        ymin: 350,\n        ymax: 450,\n        precision: 3\n    },\n    'CO2_hilat': {\n        label: '[CO2]',\n        ymin: 5,\n        ymax: 15,\n        precision: 3\n    },\n    'HCO3_hilat': {\n        label: '[HCO3]',\n        ymin: 1500,\n        ymax: 2000,\n        precision: 4\n    },\n    'CO3_hilat': {\n        label: '[CO3]',\n        ymin: 70,\n        ymax: 120,\n        precision: 3\n    },\n    'pH_lolat': {\n        label: 'pH',\n        ymin: 7.5,\n        ymax: 8.5,\n        precision: 3\n    },\n    'fCO2_lolat': {\n        label: 'fCO2',\n        ymin: 350,\n        ymax: 450,\n        precision: 3\n    },\n    'pCO2_lolat': {\n        label: 'pCO2',\n        ymin: 350,\n        ymax: 450,\n        precision: 3\n    },\n    'CO2_lolat': {\n        label: '[CO2]',\n        ymin: 5,\n        ymax: 15,\n        precision: 3\n    },\n    'HCO3_lolat': {\n        label: '[HCO3]',\n        ymin: 1500,\n        ymax: 2000,\n        precision: 4\n    },\n    'CO3_lolat': {\n        label: '[CO3]',\n        ymin: 70,\n        ymax: 120,\n        precision: 3\n    },\n    'c_deep': {\n        label: '\\u03A9',\n        ymin: 0,\n        ymax: 1,\n        precision: 2\n    },\n    'c_lolat': {\n        label: '\\u03A9',\n        ymin: 0,\n        ymax: 1,\n        precision: 2\n    },\n    'c_hilat': {\n        label: '\\u03A9',\n        ymin: 0,\n        ymax: 1,\n        precision: 2\n    },\n    'pCO2_atmos': {\n        label: 'pCO2',\n        ymin: 350,\n        ymax: 450,\n        precision: 4\n    },\n    'pCO2_atmos_noExch': {\n        label: 'pCO2',\n        ymin: 350,\n        ymax: 450,\n        precision: 4\n    },\n    'temp_lolat': {\n        label: 'Temp',\n        ymin: 20,\n        ymax: 25,\n        precision: 3\n    },\n    'temp_hilat': {\n        label: 'Temp',\n        ymin: 2,\n        ymax: 6,\n        precision: 3\n    },\n    'temp_deep': {\n        label: 'Temp',\n        ymin: 0,\n        ymax: 4,\n        precision: 3\n    },\n    'sal_lolat': {\n        label: 'Temp',\n        ymin: 36,\n        ymax: 34,\n        precision: 3\n    },\n    'sal_hilat': {\n        label: 'Temp',\n        ymin: 36,\n        ymax: 34,\n        precision: 3\n    },\n    'sal_deep': {\n        label: 'Temp',\n        ymin: 36,\n        ymax: 34,\n        precision: 3\n    },\n};","import React from 'react';\nimport Slider from 'react-rangeslider'\nimport 'react-rangeslider/lib/index.css'\n\nexport class Button extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.handleClick = this.handleClick.bind(this)\n    }\n\n    handleClick() {\n        this.props.onClick()\n    }\n\n    render() {\n        return (\n            <button className=\"button\" onClick={this.handleClick}>\n                {this.props.label}\n            </button>\n        )\n    }\n\n}\n\n// https://whoisandy.github.io/react-rangeslider/\nexport class VerticalSlider extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.handleChange = this.handleChange.bind(this)\n        this.fmtLabel = this.fmtLabel.bind(this)\n    }\n\n    handleChange = value => {\n        this.props.handleChange(value)\n      };\n\n    fmtLabel(value) {\n        return this.props.fmt_info[0](value, this.props.fmt_info[1])\n    }\n\n    render() {\n        return (\n            <Slider \n                value={this.props.value}\n                min={this.props.min}\n                max={this.props.max}\n                orientation='vertical'\n                onChange={this.handleChange}\n                format={this.fmtLabel}\n                labels={this.props.labels}\n                step={this.props.step}\n            />\n        )\n    }\n\n}\n\n","import React from 'react';\nimport Button from 'react-bootstrap/Button';\nimport { VerticalSlider } from './ControlElements';\nimport { start_state } from './ThreeBox_full'\n\nfunction fmt_sci(value, precision) {\n    return value.toExponential(precision)\n}\n\nfunction fmt_pre(value, precision) {\n    return value.toPrecision(precision)\n}\n\nfunction fmt_fix(value, decimals) {\n    return value.toFixed(decimals)\n}\nconst paramFormats = {\n    vcirc: [fmt_sci, 1, start_state.vcirc * 0.5, start_state.vcirc * 2],\n    vmix: [fmt_sci, 1, start_state.vmix * 0.5, start_state.vmix * 2],\n    tau_hilat: [fmt_pre, 2, 30, 100],\n    tau_lolat: [fmt_pre, 2, 1, 10, 0.1],\n    percent_CaCO3_hilat: [fmt_pre, 2, 0, 50],\n    percent_CaCO3_lolat: [fmt_pre, 2, 0, 50],\n    temp_hilat: [fmt_fix, 1, 0, 10, 0.1],\n    temp_lolat: [fmt_fix, 1, 20, 30, 0.1]\n}\n\nconst sliderLabels = {\n    vcirc: {[start_state.vcirc]: '', [start_state.vcirc * 2]: 'x2', [start_state.vcirc / 2]: '/2'},\n    vmix: {[start_state.vmix]: '', [start_state.vmix * 2]: 'x2', [start_state.vmix / 2]: '/2'},\n    tau_hilat: {[start_state.tau_hilat]: ''},\n    tau_lolat: {[start_state.tau_lolat]: ''},\n    percent_CaCO3_hilat: {[start_state.percent_CaCO3_hilat]: ''},\n    percent_CaCO3_lolat: {[start_state.percent_CaCO3_lolat]: ''},\n    temp_hilat: {[start_state.temp_hilat]: ''},\n    temp_lolat: {[start_state.temp_lolat]: ''},\n}\n\nconst slidersteps = {\n    temp_hilat: 0.1,\n    temp_lolat: 0.1,\n}\n\nconst labels = {\n    vcirc: 'V<sub>circ</sub>',\n    vmix: 'V<sub>mix</sub>',\n    tau_hilat: '&tau;',\n    tau_lolat: '&tau;',\n    percent_CaCO3_hilat: '% CaCO<sub>3</sub>',\n    percent_CaCO3_lolat: '% CaCO<sub>3</sub>',\n    temp_hilat: 'Temp',\n    temp_lolat: 'Temp',\n}\n\nexport class ControlSet extends React.Component {\n    constructor(props) {\n        super(props)\n        this.handleDouble = this.handleDouble.bind(this);\n        this.handleHalve = this.handleHalve.bind(this);    \n        this.handleSliderChange = this.handleSliderChange.bind(this);    \n    }\n\n    handleDouble(e) {\n        this.props.handleUpdate(this.props.param, this.props.value * 2)\n    }\n\n    handleHalve(e) {\n        this.props.handleUpdate(this.props.param, this.props.value / 2)\n    }\n\n    handleSliderChange(value) {\n        this.props.handleUpdate(this.props.param, value)\n    }\n\n    render () {\n        let min = paramFormats[this.props.param][2];\n        let max = paramFormats[this.props.param][3];\n        let stepsize = paramFormats[this.props.param][4];\n\n        return (\n            <div className=\"control-set\">\n                <h3 dangerouslySetInnerHTML={{__html: labels[this.props.param]}}></h3>\n                <VerticalSlider value={this.props.value} min={min} max={max} handleChange={this.handleSliderChange} fmt_info={paramFormats[this.props.param]} labels={sliderLabels[this.props.param]} step={stepsize}/>\n                <div className=\"control-value\">\n                {paramFormats[this.props.param][0](this.props.value, paramFormats[this.props.param][1])}\n                </div>\n            </div>\n        )\n    } \n}\n\nexport class Disasters extends React.Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            GtC_pinutubo: 0.05 * 0.272,\n            emitLabel: 'Burn!'\n        }\n    \n        this.handleStHelens = this.handleStHelens.bind(this)\n        this.handlePinatubo = this.handlePinatubo.bind(this)\n        // this.handleTambora = this.handleTambora.bind(this)\n        this.handleEmissions = this.handleEmissions.bind(this)\n    }\n\n    handleStHelens() {\n        this.props.handleVolcano(0.01 * 0.272)\n    }\n\n    handlePinatubo() {\n        this.props.handleVolcano(0.05 * 0.272)\n    }\n\n    // handleTambora() {\n    //     this.props.handleVolcano(0.05 * 0.272)\n    // }\n\n    handleEmissions() {\n        this.props.handleEmissions()\n        if (this.state.emitLabel === 'Burn!') {\n            this.setState({emitLabel: 'Stop.'});\n        } else {\n            this.setState({emitLabel: 'Burn!'});\n        }\n    }\n\n    render () {\n        return (\n        <div className=\"control-section disasters\" style={{zIndex: 5}}>\n            <h2>Carbon Release: {this.props.GtC_released.toFixed(2)} GtC</h2>\n            <div className=\"model-controls\">\n            <div className=\"control-set\">\n                <h3>Fossil Fuels</h3>\n                <Button onClick={this.handleEmissions} size=\"sm\">{this.state.emitLabel}</Button>\n                {/* <div className=\"control-value\">\n                \n                </div> */}\n            </div>\n            <div className=\"control-set\">\n                <h3>Volcanos</h3>\n                {/* <VerticalSlider/> */}\n                {/* <Button size=\"sm\">St. Helens</Button> */}\n                <Button onClick={this.handleStHelens} size=\"sm\">St. Helens</Button>\n                <Button onClick={this.handlePinatubo} size=\"sm\">Pinatubo</Button>\n                {/* <Button onClick={this.handleVolcano} size=\"sm\">Tambora</Button> */}\n            </div>\n            </div>\n        </div>\n        )\n    }\n}\n\nconst climate_sensitivity = 2.5;  // degrees C per doubling CO2\n\nfunction calc_deltaF(pCO2) {\n    return 5.35 * Math.log(pCO2 / start_state.pCO2_atmos)\n}\n\nfunction calc_deltaT(pCO2) {\n    return climate_sensitivity * pCO2 / start_state.pCO2_atmos - climate_sensitivity\n}\n\nexport class RadiativeForcing extends React.Component {\n    render () {\n        return (\n        <div className=\"control-section forcing\" style={{zIndex: 5}}>\n            <h2>Climate: Radiative Forcing </h2>\n            <div className=\"model-controls\">\n            <div className='control-set table'>\n                {/* titles */}\n                <div className=\"table cell title\"></div>\n                <div className=\"table cell head\">No Ocean</div>\n                <div className=\"table cell head\">With Ocean</div>\n                <div className=\"table cell title\"></div>\n                {/* Row 1 - pCO2 */}\n                <div \n                    className=\"table cell title\" \n                    dangerouslySetInnerHTML={{__html: \"pCO<sub>2</sub>\"}}>\n                </div>\n                <div className=\"table cell\"> {this.props.pCO2_atmos_noExch.toFixed(1)}</div>\n                <div className=\"table cell\"> {this.props.pCO2_atmos.toFixed(1)}</div>\n                <div className=\"table cell unit\">ppm</div>\n                {/* Row 2 - Delta F */}\n                <div \n                    className=\"table cell title\" \n                    dangerouslySetInnerHTML={{__html: \"\\u0394F\"}}>\n                </div>\n                <div className=\"table cell\"> {calc_deltaF(this.props.pCO2_atmos_noExch).toFixed(1)}</div>\n                <div className=\"table cell\"> {calc_deltaF(this.props.pCO2_atmos).toFixed(1)}</div>\n                <div className=\"table cell unit\" dangerouslySetInnerHTML={{__html: \"W m<sup>-2</sup>\"}}></div>\n                {/* Row 3 - Delta T */}\n                <div \n                    className=\"table cell title\" \n                    dangerouslySetInnerHTML={{__html: \"\\u0394T\"}}>\n                </div>\n                <div className=\"table cell\"> {calc_deltaT(this.props.pCO2_atmos_noExch).toFixed(1)}</div>\n                <div className=\"table cell\"> {calc_deltaT(this.props.pCO2_atmos).toFixed(1)}</div>\n                <div className=\"table cell unit\" dangerouslySetInnerHTML={{__html: \"\\u2103\"}}></div>\n            </div>\n            </div>\n        </div>\n        )\n    }\n\n}\n\n\nexport class ModelControls extends React.Component {\n    render () {\n        let controls = [];\n        for (let p of this.props.params) {\n            controls.push(\n                <ControlSet \n                    key={p}\n                    param={p}\n                    value={this.props.now[p]}\n                    handleUpdate={this.props.handleUpdate}\n                />\n            )\n        }\n\n        return (\n            <div className=\"control-section\">\n                <h2>{this.props.title}</h2>\n                <div className=\"model-controls\">\n                    {controls}\n                </div>\n            </div>\n        )\n    } \n}","import React, { Component } from 'react'\nimport * as d3 from 'd3';\n\nexport class Graph extends Component {\n  constructor(props) {\n    super(props);\n    this.interval = null;\n    this.graph = {};\n\n    this.graph.data = this.make_data();\n  }\n\n  getYLimits(pad) {\n    let mn = Infinity;\n    let mx = -Infinity;\n    for (let d of this.graph.data) {\n      for (let v of d) {\n        if (v[1] < mn) { mn = v[1] }\n        if (v[1] > mx) { mx = v[1] }\n      }\n    }\n    for (let v of this.props.variables) {\n      if (mn > this.props.var_info[v]['ymin']) { mn = this.props.var_info[v]['ymin']}\n      if (mx < this.props.var_info[v]['ymax']) { mx = this.props.var_info[v]['ymax']}\n    }\n    let rn = mx - mn;\n    if (rn === 0) {\n      rn = 10;\n    }\n    return [mn - rn * pad, mx + rn * pad]\n  }\n\n  make_data() {\n    let pdatas = [];\n    for (let v of this.props.variables) {\n      let data = this.props.data[v]\n      let pdata = [];\n      let ix = - data.length + 1;\n      for (let i = 0; i < data.length; i++) {\n        pdata.push([ix, data[i]])\n        ix += 1\n      }\n      pdatas.push(pdata)\n    }\n    return pdatas\n  }\n\n  initGraph() {\n    // size and padding\n    var margin = 6;\n    var axis_left = 35;\n    var axis_bottom = 20;\n    this.graph.bb = d3.select(\"#\" + this.props.id).node().getBoundingClientRect();\n\n    var svg_height = this.graph.bb.height,\n        svg_width = this.graph.bb.width;\n      \n    var height = svg_height - axis_bottom - margin,\n        width = svg_width - axis_left - margin;\n\n    this.graph.xScale = d3.scaleLinear()\n      .domain([-this.props.npoints, 0])\n      .range([0, width]);\n\n    this.graph.yScale = d3.scaleLinear()\n      .domain(this.getYLimits(0.05))\n      .range([height, 0]);\n\n    this.graph.svg = d3.select(\"#\" + this.props.id)\n      .append('svg')\n        .attr('id', 'svg_' + this.props.id)\n        .attr('viewBox', `0 0 ${svg_width} ${svg_height}`)\n      .append('g')\n        .attr('transform', 'translate(' + axis_left + ', ' + margin + ')')\n    \n    this.graph.yAxis = d3.axisLeft(this.graph.yScale).ticks(2)    \n    this.graph.svg.append('g')\n      .attr(\"class\", \"y axis\")\n      .call(this.graph.yAxis)\n\n    this.graph.xAxis = d3.axisBottom(this.graph.xScale).ticks(2)\n    this.graph.svg.append('g')\n      .attr(\"class\", \"x axis\")\n      .attr(\"transform\", \"translate(0,\" + (100 - axis_bottom + margin + 1) + \")\")\n      .call(this.graph.xAxis)\n\n    this.graph.lines = []\n    for (let v of this.props.variables) {\n      this.graph.lines.push(\n        d3.line()\n        .x((d) => this.graph.xScale(d[0]))\n        .y((d) => this.graph.yScale(d[1]))\n      )\n    }\n    \n    for (let i in this.graph.data) {\n      this.graph.svg.append('path')\n        .attr('id', 'dataline')\n        .attr('id', this.props.id + i)\n        .attr('d', this.graph.lines[i](this.graph.data[i]))\n    }\n  }\n\n  updateLine() {\n    for (let i in this.graph.data) {\n      this.graph.svg.selectAll('path#' + this.props.id + i)\n      .attr('d', this.graph.lines[i](this.graph.data[i]))\n    }\n  }\n\n  updateYlim() {\n    this.graph.yScale.domain(this.getYLimits(0.05))\n    this.graph.yAxis.scale(this.graph.yScale)\n    d3.select(\"#\" + this.props.id).select('.y').call(this.graph.yAxis)\n  }\n\n  updateXlim() {\n   this.graph.xScale.domain([-this.props.npoints, 0]) \n   this.graph.xAxis.scale(this.graph.xScale)\n    d3.select(\"#\" + this.props.id).select('.x').call(this.graph.xAxis)\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n\n  componentDidMount() {\n    this.initGraph()\n  }\n\n  componentDidUpdate() {\n    this.graph.data = this.make_data();\n    this.updateXlim()\n    this.updateYlim()\n    this.updateLine()\n  }\n\n  render () {\n    return (\n        <div className='graph-pane' style={{\n            left: this.props.pos[0] + '%',\n            bottom: this.props.pos[1] + '%', \n            width: this.props.pos[2] + '%', \n            height: this.props.pos[3] + '%',\n          }}>\n          <div className=\"subgraph\" id={this.props.id} style={{height: this.props.height}}>\n            <div className=\"subgraph-label\" dangerouslySetInnerHTML={{__html: this.props.label}}></div>\n          </div>\n        </div>\n    )\n  } \n}\n","import React, { Component } from 'react'\nimport { moles2GtC, uatm2GtC } from './csys'\nimport { var_info, paramLabels } from './ThreeBox_full'\nimport { Graph } from './Graph';\n\nconst divid = \"threebox\"\n\n// const flux_labels = ['CO<sub>2</sub>', '[PO<sub>4</sub>]', '[DIC]', 'Alkalinity']\n// const flux_colors = [\"#888e9b\", \"#d3ca98\", \"#e98787\", \"#e7abef\"]  // CO2, PO4, DIC, TA\n// const plot_bkg = \"black\"\n\nconst flux_labels = ['CO<sub>2</sub> Exchange', 'Thermohaline Circulation', 'Vertical Mixing', 'Biological Export'];\nconst flux_colors = ['#888e9b', '#5369dcff', '#202080ff', '#307f2aff'];\n\nexport class Box extends Component {\n  render() {\n    return (\n    <div className=\"box\" id={this.props.id} \n    style={{\n      left: this.props.pos[0] + '%',\n      bottom: this.props.pos[1] + '%', \n      width: this.props.pos[2] + '%', \n      height: this.props.pos[3] + '%',\n      backgroundColor: this.props.color\n    }}>\n      <div className='box-value' id={this.props.id}>{this.props.value}</div>\n      <div className='box-label' id={this.props.id}>{this.props.label + ': ' + this.props.GtC.toFixed(0) + ' GtC'}</div>\n    </div>\n    )\n  }\n}\n\nfunction mapValue(val, min, max, h, s) {\n  let range = 0.8;\n  return 100 * ((1 - range) / 2 + range * (1 - (val - min) / (max - min)))\n}\n\nfunction parseHSL(h, s, l) {\n  return \"hsl(\" + h + \",\" + s + \"%,\" + l + \"%)\"\n}\n\n// function neg_color(lightness) {\n//   let delta_lightness = 50;\n//   if (lightness > 50) {\n//     return lightness - delta_lightness\n//   } else {\n//     return lightness + delta_lightness\n//   }\n// }\n\nexport class Schematic extends Component {\n\n  getLimits() {\n    let gMin = Math.min(\n      Math.min(...this.props.data[this.props.param + '_deep']),\n      Math.min(...this.props.data[this.props.param + '_hilat']),\n      Math.min(...this.props.data[this.props.param + '_lolat'])\n    );\n    let gMax = Math.max(\n      Math.max(...this.props.data[this.props.param + '_deep']),\n      Math.max(...this.props.data[this.props.param + '_hilat']),\n      Math.max(...this.props.data[this.props.param + '_lolat'])\n    );\n    if (gMin === gMax) {\n      gMin -= 1;\n      gMax += 1;\n    }\n    return [gMin, gMax]\n  }\n  \n  render() {\n    let limits = this.getLimits();\n    let ind = this.props.data['pCO2_atmos'].length - 1;\n\n    // Define color pallette\n    let h = 200;\n    let s = 51;\n\n    let val_atmos = this.props.data['pCO2_atmos'][ind];\n\n    let val_deep = this.props.data[this.props.param + '_deep'][ind];\n    let l_deep = mapValue(val_deep, limits[0], limits[1]);\n    let col_deep = parseHSL(h, s, l_deep);\n\n    let val_lolat = this.props.data[this.props.param + '_lolat'][ind];\n    let l_lolat = mapValue(val_lolat, limits[0], limits[1]);\n    let col_lolat = parseHSL(h, s, l_lolat);\n    \n    let val_hilat = this.props.data[this.props.param + '_hilat'][ind];\n    let l_hilat = mapValue(val_hilat, limits[0], limits[1]);\n    let col_hilat = parseHSL(h, s, l_hilat);\n\n    // GtC in each reservoir\n    let GtC_atmos = uatm2GtC(this.props.data['pCO2_atmos'][ind])\n    let GtC_deep = moles2GtC(this.props.data['DIC_deep'][ind] * 1e-3 * this.props.data['vol_deep'][ind])\n    let GtC_lolat = moles2GtC(this.props.data['DIC_lolat'][ind] * 1e-3 * this.props.data['vol_lolat'][ind])\n    let GtC_hilat = moles2GtC(this.props.data['DIC_hilat'][ind] * 1e-3 * this.props.data['vol_hilat'][ind])\n\n    // Generate legend\n    let legend = [];\n    for (let i = 0; i < flux_colors.length; i++) {\n      // console.log(legend_items[i])\n      legend.push(\n        <div className='legend item'>\n          <div className='legend key' style={{backgroundColor: flux_colors[i]}}></div>\n          <div className='legend label' dangerouslySetInnerHTML={{__html: flux_labels[i]}}></div>\n        </div>\n      )\n    }\n    // console.log([this.props.fluxes.vcirc_PO4_hilat / this.props.data.vol_deep[ind]])\n    return (\n      <div className=\"schematic-container\">\n      <div className=\"schematic\" id={divid}>\n        {/* Boxes */}\n        <Box \n          id='atmos'\n          pos = {[0, 80, 100, 20]}\n          color = \"white\"\n          value = {\"pCO2: \" + val_atmos.toPrecision(this.props.var_info['pCO2_atmos']['precision'])}\n          label = \"Atmosphere\"\n          GtC = {GtC_atmos}\n        />\n        <Box \n          id='deep'\n          pos = {[0, 0, 100, 50]}\n          color = {col_deep}\n          value = {val_deep.toPrecision(this.props.var_info[this.props.param + '_deep']['precision'])}\n          label = \"Deep Ocean\"\n          GtC = {GtC_deep}\n        />\n        <Box \n          id='lolat'\n          pos = {[35, 50, 65, 30]}\n          color = {col_lolat}\n          value = {val_lolat.toPrecision(this.props.var_info[this.props.param + '_deep']['precision'])}\n          label = \"Low Lat. Surface Ocean\"\n          GtC = {GtC_lolat}\n        />\n        <Box \n          id='hilat'\n          pos = {[0, 40, 35, 40]}\n          color = {col_hilat}\n          value = {val_hilat.toPrecision(this.props.var_info[this.props.param + '_deep']['precision'])}\n          label = \"High Lat. Surface Ocean\"\n          GtC = {GtC_hilat}\n        />\n        {/* Graphs */}\n        <Graph\n          pos = {[38, 84, 22, 12]}\n          data={this.props.data}\n          npoints={this.props.npoints}\n          variables={['pCO2_atmos_noExch', 'pCO2_atmos']}\n          var_info={var_info}\n          label=\"pCO<sub>2</sub>\"\n          id = 'g_atmos_noex'\n        />\n\n        <Graph\n          pos = {[2, 54, 22, 12]}\n          data={this.props.data}\n          npoints={this.props.npoints}\n          variables={[this.props.plot_hilat]}\n          var_info={var_info}\n          label={paramLabels[this.props.param]}\n          id = 'g_hilat'\n        />\n\n        <Graph\n          pos = {[76, 58, 22, 12]}\n          data={this.props.data}\n          npoints={this.props.npoints}\n          variables={[this.props.plot_lolat]}\n          var_info={var_info}\n          label={paramLabels[this.props.param]}\n          id = 'g_lolat'\n        />\n\n        <Graph\n          pos = {[38, 10, 22, 12]}\n          data={this.props.data}\n          npoints={this.props.npoints}\n          variables={[this.props.plot_deep]}\n          var_info={var_info}\n          label={paramLabels[this.props.param]}\n          id = 'g_deep'\n        />\n\n        {/* Flux Arrows */}\n        {/* CO2 Exchange */}\n        <Fluxes fluxes={[moles2GtC(-this.props.fluxes.exCO2_hilat)]} sizes={[0.3]} centre={[18, 20]} colors={[flux_colors[0]]} label='Gas exch.' id='gas'/>\n        <Fluxes fluxes={[moles2GtC(-this.props.fluxes.exCO2_lolat)]} sizes={[0.3]} centre={[70, 20]} colors={[flux_colors[0]]} label='Gas exch.' id='gas'/>\n        {/* Thermohaline Mixing */}\n        <Fluxes \n          fluxes={[this.props.fluxes.vcirc_DIC_deep / this.props.data.vol_ocean[ind]]}\n          sizes={[0.1]}\n          centre={[35, 55]}\n          colors={[flux_colors[1]]}\n          label=\"V<sub>circ</sub>\"\n          id='hideep'\n          />\n        <Fluxes \n          fluxes={[this.props.fluxes.vcirc_DIC_lolat / this.props.data.vol_ocean[ind]]}\n          sizes={[0.1]}\n          centre={[39, 50]}\n          colors={[flux_colors[1]]}\n          label=\"V<sub>circ</sub>\"\n          />\n        <Fluxes \n          fluxes={[this.props.fluxes.vcirc_DIC_hilat / this.props.data.vol_ocean[ind]]}\n          sizes={[0.1]}\n          centre={[35, 42]} \n          colors={[flux_colors[1]]}\n          label=\"V<sub>circ</sub>\"\n          id='lohi'\n          />\n        {/* Diffusive Mixing */}\n        <Fluxes \n          fluxes={[-this.props.fluxes.vmix_DIC_hilat / this.props.data.vol_ocean[ind]]}\n          sizes={[0.1]}\n          centre={[24, 60]}\n          colors={[flux_colors[2]]}\n          label=\"V<sub>mix</sub>\"\n          />\n        <Fluxes \n          fluxes={[-this.props.fluxes.vmix_DIC_lolat / this.props.data.vol_ocean[ind]]}\n          sizes={[0.1]}\n          centre={[54, 50]}\n          colors={[flux_colors[2]]}\n          label=\"V<sub>mix</sub>\"\n          />\n        {/* Productivity */}\n        <Fluxes \n          fluxes={[-this.props.fluxes.prod_DIC_hilat / this.props.data.vol_ocean[ind]]}\n          sizes={[0.1]}\n          centre={[16, 60]}\n          colors={[flux_colors[3]]}\n          label=\"&tau;\"\n          />\n        <Fluxes \n          fluxes={[-this.props.fluxes.prod_DIC_lolat / this.props.data.vol_ocean[ind]]}\n          sizes={[0.1]}\n          centre={[64, 50]}\n          colors={[flux_colors[3]]}\n          label=\"&tau;\"\n          />\n\n        <div className='legend box'>\n          <h3>Net DIC Fluxes</h3>\n          {legend}\n        </div>\n      \n      </div>\n      </div>\n    )\n  }\n}\n\nclass Fluxes extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      arrowWidthPercent: 3,\n      arrowHeightPercent: 10,\n    }\n\n    this.style = {\n      width: this.props.fluxes.length * this.state.arrowWidthPercent + \"%\",\n      height: this.state.arrowHeightPercent + \"%\",\n      left: this.props.centre[0] - this.props.fluxes.length * this.state.arrowWidthPercent / 2 + '%',\n      top: this.props.centre[1] - this.state.arrowHeightPercent * 0.5 + \"%\"\n    }\n  }\n\n  render() {\n    let arrows = [];\n    let n = this.props.fluxes.length;\n    let pos = 0;\n    for (let i = 0; i < n; i++) {\n      arrows.push(\n        <Arrow direction={this.props.fluxes[i]} width={100 / n + '%'} amplitude={this.props.sizes[i]} color={this.props.colors[i]}/>\n      )\n      if (this.props.fluxes[i] > 0) {\n        pos += 1;\n      } else {\n        pos -= 1;\n      }\n    }\n    \n    let labelPos = {}\n    if (pos < 0) {\n       labelPos.bottom = '55%'\n      } else {\n        labelPos.top = '55%'\n      }\n\n    return (\n      <div className=\"flux-pane\" id={this.props.id} style={this.style}>\n        <div className=\"flux-label\" dangerouslySetInnerHTML={{__html: this.props.label}} style={labelPos}></div>\n        {arrows}\n      </div>\n    )\n  }\n}\n\nclass Arrow extends Component {\n  // constructor(props) {\n  //   super(props)\n  // }\n\n  size_2_percent(size) {\n    return Math.abs(50 * size / this.props.amplitude) + '%'\n  }\n\n  render() {\n    let arrowStyle = {\n      width: \"33%\",\n      // left: \"0%\",\n      backgroundColor: this.props.color\n    }\n    if (this.props.direction >= 0) {\n      arrowStyle.bottom = \"50%\"\n      arrowStyle.height = this.size_2_percent(this.props.direction)\n    } else {\n      arrowStyle.top = \"50%\"\n      arrowStyle.height = this.size_2_percent(this.props.direction)\n    }\n\n    // console.log(arrowStyle)\n\n    return ( \n      <div className='flux-box' style={{width: this.props.width}}>\n        <div className='flux-arrow' style={arrowStyle}>\n          \n        </div>\n      </div>\n      )\n  }\n\n}","import React from 'react';\nimport ToggleButtonGroup from 'react-bootstrap/ToggleButtonGroup'\nimport ToggleButton from 'react-bootstrap/ToggleButton'\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport {paramLabels} from './ThreeBox_full'\n\nexport class ParamButtons extends React.Component {\n    render() {\n        let buttons = [];\n        for (let p of this.props.params) {\n            buttons.push(\n                <ToggleButton key={p} value={p}><div dangerouslySetInnerHTML={{__html: paramLabels[p]}}></div></ToggleButton>\n            )\n        }\n        return (\n            <ToggleButtonGroup type=\"checkbox\" size='sm' onChange={this.props.onChange} defaultValue={this.props.defaultValue}>\n                {buttons}\n            </ToggleButtonGroup>\n        )\n    }\n}\n\nexport class ParamToggle extends React.Component {\n    render() {\n        let buttons = [];\n        for (let p of this.props.params) {\n            buttons.push(\n                <ToggleButton key={p} value={p}><div dangerouslySetInnerHTML={{__html: paramLabels[p]}}></div></ToggleButton>\n            )\n        }\n        return (\n            <ToggleButtonGroup type=\"radio\" name=\"plot_params\" size='sm' onChange={this.props.onChange} defaultValue={this.props.defaultValue}>\n                {buttons}\n            </ToggleButtonGroup>\n        )\n    }\n}","import React from 'react';\nimport { start_state, step, calc_fluxes, var_info} from './ThreeBox_full';\nimport Button from 'react-bootstrap/Button'\nimport ButtonGroup from 'react-bootstrap/ButtonGroup'\nimport InputGroup from 'react-bootstrap/InputGroup'\nimport FormControl from 'react-bootstrap/FormControl'\nimport { Disasters, ModelControls, RadiativeForcing } from './ModelControls'\nimport { Schematic } from './Schematic';\nimport { ParamToggle } from './ParamButtons';\nimport {calc_Ks, GtC2uatm, uatm2GtC} from './csys'\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nconst GtC_atmos_0 = uatm2GtC(372.8);\n// const frameTime = 20;\n// const npoints = 200;\n\nexport class Model extends React.Component {\n    constructor(props) {\n        super(props)\n\n        // Set model state\n        this.state = {\n            start_state: start_state,\n            now: start_state,\n            history: {},\n            fluxes: calc_fluxes(start_state),\n            npoints: 200,\n            year_field: 200,\n            frameTime: 20,  // ms\n        };\n        // Calculate Ks\n        this.state['Ks'] = this.genKs(start_state)\n\n        // Set arrays to record model state\n        for (let key in this.state.now) {\n            this.state.history[key] = new Array(2).fill(this.state.now[key]);\n          };\n        \n        this.state.yearsPerSecond = 1 / this.state.frameTime * 1e3\n\n        //   Default parameter to show in schematic\n        this.state['schematicParam'] = 'pCO2'\n        \n        // Model Params\n        this.state['model_global_params'] = ['vmix', 'vcirc'] \n        this.state['model_hilat_params'] = ['tau_hilat', 'percent_CaCO3_hilat', 'temp_hilat']\n        this.state['model_lolat_params'] = ['tau_lolat', 'percent_CaCO3_lolat', 'temp_lolat']\n\n        //   Default plot setup\n        this.state['ocean_vars'] = ['pCO2', 'DIC', 'pH', 'CO3', 'HCO3', 'CO2'];\n        this.state['plot_atmos'] = ['pCO2_atmos',];\n        this.state['plot_ocean'] = ['pCO2']\n        for (let box of ['_deep', '_hilat', '_lolat']) {\n            this.state['plot' + box] = [this.state.plot_ocean[0] + box]\n        }\n\n        // Whether or not to run the model.\n        this.state['start_stop_button'] = \"Pause\";\n\n        this.state.running = true;\n        this.interval = null;\n\n        this.emitting = false;\n        this.state.GtC_released = 0;\n\n        this.stepModel = this.stepModel.bind(this);\n        this.startSimulation = this.startSimulation.bind(this)\n        this.stopSimulation = this.stopSimulation.bind(this)\n        this.resetModel = this.resetModel.bind(this)\n        this.toggleSimulation = this.toggleSimulation.bind(this)\n        this.genPlotVars = this.genPlotVars.bind(this)\n        this.genKs = this.genKs.bind(this)\n\n\n        this.handleDropdownSelect = this.handleDropdownSelect.bind(this)\n        this.handleParamButtonChange = this.handleParamButtonChange.bind(this)\n        this.handleParamToggle = this.handleParamToggle.bind(this)\n        this.handleParamUpdate = this.handleParamUpdate.bind(this)\n\n        this.handleVolcano = this.handleVolcano.bind(this)\n        this.toggleEmissions = this.toggleEmissions.bind(this)\n\n        this.onChangeYears = this.onChangeYears.bind(this)\n        this.onYearsEnter = this.onYearsEnter.bind(this)\n        this.handleUpdateYears = this.handleUpdateYears.bind(this)\n        \n        this.handleSpeedUp = this.handleSpeedUp.bind(this)\n        this.handleSlowDown = this.handleSlowDown.bind(this)\n    }\n\n    startSimulation() {\n        if (this.interval == null) {\n            this.interval = setInterval(() => {\n                this.stepModel()\n            }, this.state.frameTime);\n        }\n        this.setState({running: true})\n    }\n\n    stopSimulation() {\n        clearInterval(this.interval);\n        this.interval = null;\n        this.setState({running: false})\n    }\n\n    toggleSimulation() {\n        if (this.interval === null) {\n            this.startSimulation()\n            this.setState({start_stop_button: \"Pause\"})\n        }  else {\n            this.stopSimulation()\n            this.setState({start_stop_button: \"Run\"})\n        }\n    }\n\n    resetModel() {\n        this.setState({\n            now: start_state, \n            fluxes: calc_fluxes(start_state),\n            history: this.updateHistory(start_state),\n            Ks: this.genKs(start_state),\n            GtC_released: 0})\n    }\n\n    stepModel() {\n        // Update Model State\n        let newState = this.state.now;\n        let GtC_release = 2;\n        let new_GtC = 0;\n        let totalEmissions = this.state.GtC_released;\n\n        if (this.emitting) {\n            newState.pCO2_atmos += GtC2uatm(GtC_release)\n            new_GtC = GtC_release;\n            totalEmissions += new_GtC;\n        }\n\n        let fluxes = calc_fluxes(newState)\n\n        newState = step(newState, fluxes, this.state.Ks);\n        // pCO2 if no ocean interaction\n        newState.pCO2_atmos_noExch = GtC2uatm(GtC_atmos_0 + this.state.GtC_released)\n        // update state\n        this.setState({\n            now: newState, \n            fluxes: fluxes, \n            history: this.updateHistory(newState), \n            GtC_released: totalEmissions,\n        });\n    };  \n\n    updateHistory(newState) {\n        let newHistory = this.state.history;\n        let len = newHistory.DIC_deep.length;\n        for (let key in this.state.now) {\n            if (len >= this.state.npoints) {\n                newHistory[key] = newHistory[key].slice(len - this.state.npoints + 1);\n            }\n            newHistory[key].push(newState[key])\n        }\n        \n        return newHistory\n    }\n\n    handleParamButtonChange(params) {\n        this.setState(this.genPlotVars(params))\n    }\n\n    handleParamToggle(param) {\n        let newState = this.genPlotVars([param])\n        newState.schematicParam = param\n        this.setState(newState)\n    }\n\n    handleVolcano(GtC) {\n        // Size of eruption (Pinatubo = 0.05 Gt CO2, or 0.05 * 0.272 Gt C)\n        let newState = this.state.now\n        newState.pCO2_atmos += GtC2uatm(GtC)\n        this.setState({now: newState, GtC_released: this.state.GtC_released + GtC});\n    }\n\n    toggleEmissions() {\n        if (this.emitting) {\n            this.emitting = false;\n        } else {\n            this.emitting = true;\n        }\n    }\n\n    genPlotVars(params) {\n        let plotvars ={\n            'plot_ocean': params,\n            'plot_atmos': ['pCO2_atmos']\n        }\n        for (let box of ['_deep', '_hilat', '_lolat']) {\n            plotvars['plot' + box] = []\n            for (let p of params) {\n                plotvars['plot' + box].push(p + box)\n            }\n        }\n        return plotvars\n    }\n\n    genKs(state) {\n        let Ks = {};\n        Ks['deep'] = calc_Ks({Tc:state.temp_deep, Sal: state.sal_deep})\n        Ks['hilat'] = calc_Ks({Tc:state.temp_hilat, Sal: state.sal_hilat})\n        Ks['lolat'] = calc_Ks({Tc:state.temp_lolat, Sal: state.sal_lolat})\n        return Ks\n    }\n\n    componentDidMount() {\n        this.startSimulation()\n    }\n\n    componentWillUnmount() {\n        this.stopSimulation()\n    }\n\n    handleDropdownSelect(param) {\n        this.setState({schematicParam: param})\n    }\n\n    handleParamUpdate(key, value){\n        // console.log(key, value)\n        let newState = this.state.now;\n        newState[key] = value;\n        this.setState({now: newState, Ks: this.genKs(newState)});\n    }\n\n    onChangeYears(event) {\n        this.setState({year_field: event.target.value})\n    }\n\n    onYearsEnter(event) {\n        if (event.key === \"Enter\") {\n            this.setState({npoints: this.state.year_field})\n        }\n    }\n\n    handleUpdateYears() {\n        this.setState({npoints: this.state.year_field})\n    }\n\n    handleSpeedUp() {\n        let newFrameTime = this.state.frameTime / 2;\n        let newYearsPerSecond = 1 / newFrameTime * 1e3;\n        \n        clearInterval(this.interval);\n        this.interval = setInterval(() => {\n            this.stepModel()\n        }, newFrameTime);\n\n        this.setState({frameTime: newFrameTime, yearsPerSecond: newYearsPerSecond});\n    }\n\n    handleSlowDown() {\n        let newFrameTime = this.state.frameTime * 2;\n        let newYearsPerSecond = 1 / newFrameTime * 1e3;\n\n        clearInterval(this.interval);\n        this.interval = setInterval(() => {\n            this.stepModel()\n        }, newFrameTime);\n\n        this.setState({frameTime: newFrameTime, yearsPerSecond: newYearsPerSecond});\n    }\n\n    render() {\n    return (\n        <div id='main-panel'>\n            <div className=\"top-bar\">\n                <div className=\"control-container\">\n                    <Disasters handleVolcano={this.handleVolcano} handleEmissions={this.toggleEmissions} GtC_released={this.state.GtC_released}/>\n                    <ModelControls title=\"Circulation\" params={this.state.model_global_params} now={this.state.now} handleUpdate={this.handleParamUpdate}/>\n                    <ModelControls title=\"High Latitude\" params={this.state.model_hilat_params} now={this.state.now} handleUpdate={this.handleParamUpdate}/>\n                    <ModelControls title=\"Low Latitude\" params={this.state.model_lolat_params} now={this.state.now} handleUpdate={this.handleParamUpdate}/>\n                    <RadiativeForcing pCO2_atmos={this.state.now.pCO2_atmos} pCO2_atmos_noExch={this.state.now.pCO2_atmos_noExch}/>\n                </div>\n            </div>\n            <div className='main-display'>\n                <Schematic \n                    param={this.state.schematicParam} \n                    data={this.state.history} \n                    fluxes={this.state.fluxes} \n                    // ocean_vars={this.state.ocean_vars} \n                    npoints={this.state.npoints} \n                    var_info={var_info} \n                    // handleDropdownSelect={this.handleDropdownSelect } \n                    plot_hilat={this.state.plot_hilat} \n                    plot_lolat={this.state.plot_lolat} \n                    plot_deep={this.state.plot_deep}\n                />\n            </div>\n            <div className=\"bottom-bar\">\n                <div id=\"plot-controls\">\n                    <ParamToggle id='plot-param-toggle' params={this.state.ocean_vars} defaultValue={this.state.plot_ocean} onChange={this.handleParamToggle}/>\n                    <div id='time-controls'>\n                        <InputGroup size='sm' className=\"control-bit\">\n                            <InputGroup.Prepend>\n                                <InputGroup.Text id=\"basic-addon1\">Model Years</InputGroup.Text>\n                            </InputGroup.Prepend>\n                            <FormControl\n                                placeholder=\"200\"\n                                aria-label=\"200\"\n                                aria-describedby=\"basic-addon2\"\n                                onChange={this.onChangeYears}\n                                onKeyPress={this.onYearsEnter}\n                            />\n                            <InputGroup.Append>\n                                <Button onClick={this.handleUpdateYears} size=\"sm\">Set</Button>\n                            </InputGroup.Append>\n                        </InputGroup>\n                        <ButtonGroup size='sm' id='speed-controls' className=\"control-bit\">\n                            <Button onClick={this.handleSlowDown} size=\"sm\">{\"\\u2193\"}</Button>\n                            <div id=\"speed-label\" dangerouslySetInnerHTML={{__html: \"Speed<br>\" + this.state.yearsPerSecond + \" yr/s\"}}></div>\n                            <Button onClick={this.handleSpeedUp} size=\"sm\">{\"\\u2191\"}</Button>\n                        </ButtonGroup>\n                        <ButtonGroup size='sm' className=\"control-bit\">\n                            <Button onClick={this.resetModel} size=\"sm\">Reset</Button>\n                            <Button onClick={this.toggleSimulation} size=\"sm\">{this.state.start_stop_button}</Button>\n                        </ButtonGroup>\n                    </div>\n                </div>\n                <div className=\"bottom-credit\">\n                    {\"\\u00A9\"} <a href=\"mailto:ob266@cam.ac.uk\">Oscar Branson</a>, Department of Earth Sciences, University of Cambridge\n                </div>\n            </div>\n        </div>\n        )\n    };\n}","import React from 'react';\nimport { Model } from './components/Model';\nimport './App.css';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Model />\n      {/* <header>\n        <div>Carbon Live</div>\n      </header>\n      <div>\n        <Model />\n      </div> */}\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}